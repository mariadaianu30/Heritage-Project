@model OnlineShop.Models.Wishlist
@{
    ViewData["Title"] = "Wishlist";
}

<h2 class="mb-4">
    <i class="fas fa-heart text-danger me-2"></i>Wishlist-ul meu
</h2>

@if (Model.WishlistItems == null || !Model.WishlistItems.Any())
{
    <div class="alert alert-info">
        Wishlist-ul este gol.
    </div>
}
else
{
    <form asp-action="Clear" method="post" class="mb-3">
        @Html.AntiForgeryToken()
        <button class="btn btn-outline-danger btn-sm"
                onclick="return confirm('Golești wishlist-ul?')">
            <i class="fas fa-trash"></i> Golește
        </button>
    </form>

    <div class="row g-4">
        @foreach (var item in Model.WishlistItems)
        {
            @if (item.Product != null)
            {
            <div class="col-md-4">
                <div class="card h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">@item.Product.Title</h5>
                        <p class="text-muted small">
                            @item.Product.Category?.Name
                        </p>

                        <p class="fw-bold text-success">
                            @item.Product.Price.ToString("0.00") RON
                        </p>

                        <div class="mt-auto d-flex gap-2">
                            <!-- Buton Adaugă în coș -->
                            <form id="addToCartForm-@item.ProductId"
                                  asp-controller="Carts"
                                  asp-action="Add"
                                  method="post" class="w-100">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="productId" value="@item.ProductId" />
                                <input type="hidden" name="quantity" value="1" />
                                <button type="submit" class="btn btn-sm btn-primary w-100">
                                    <i class="fas fa-cart-plus"></i>
                                </button>
                            </form>

                            <!-- Buton Elimină din wishlist -->
                            <form asp-action="Remove" method="post">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="id" value="@item.Id" />
                                <button class="btn btn-sm btn-outline-danger">
                                    <i class="fas fa-times"></i>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            }
        }
    </div>
}
